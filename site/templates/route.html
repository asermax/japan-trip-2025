{% extends "basic.html" %}

{% block title %}{{ config.title }} ‚Ä¢ {{ section.title }}{% endblock title %}

{% block extra_head %}
<script>
// Override back button to go to journey entry page
document.addEventListener('DOMContentLoaded', function() {
  const backBtn = document.querySelector('.back_btn a');
  {% if section.extra.journey_entry %}
  if (backBtn) {
    backBtn.onclick = function(e) {
      e.preventDefault();
      window.location.href = '/{{ section.extra.journey_entry }}/';
    };
  }
  {% endif %}
});
</script>

{% if section.extra.map_data %}
<!-- Map Styles -->
<link rel="stylesheet" href="/css/maps.css">
<!-- Custom Maps JavaScript - Load before Google Maps API -->
<script src="/js/maps.js"></script>
<!-- Google Maps API -->
<script src="https://maps.googleapis.com/maps/api/js?key={{ config.extra.google_maps_api_key }}&callback=initMap&libraries=&v=weekly" async defer></script>
{% endif %}
{% endblock extra_head %}

{% block content %}
<article class="post animated fadeInDown">
  <div class="post-title">
    <div class="timeline-type timeline-type-journey">
      üöó Route Guide
    </div>
    <h1>{{ section.title }}</h1>
  </div>

  <div class="post-content">
    {% if section.extra.route_type or section.extra.distance or section.extra.drive_time %}
    <div class="meta">
      {% if section.extra.route_type %}
      <div><strong>üõ£Ô∏è Type:</strong> {{ section.extra.route_type }}</div>
      {% endif %}
      {% if section.extra.transportation %}
      <div><strong>üöó Transportation:</strong> {{ section.extra.transportation }}</div>
      {% endif %}
      {% if section.extra.distance %}
      <div><strong>üìè Distance:</strong> {{ section.extra.distance }}</div>
      {% endif %}
      {% if section.extra.drive_time %}
      <div><strong>‚è±Ô∏è Drive Time:</strong> {{ section.extra.drive_time }}</div>
      {% endif %}
    </div>
    {% endif %}

    {{ section.content | safe }}

    {% if section.extra.map_data %}
    <div class="map-section">
      <h2>üó∫Ô∏è Route Stops Map</h2>
      <div id="route-map" class="map-container" data-map-markers="{{ section.extra.map_data }}"></div>
      <p class="map-help">Click on any pin to visit the stop's detail page</p>
    </div>
    {% endif %}
  </div>

  <div class="post-footer">
    {% if section.taxonomies.tags %}
    <div class="tags">
      <ul>
        {% for tag in section.taxonomies.tags %}
        <li><a href="/tags/{{ tag | slugify }}/">#{{ tag }}</a></li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}
  </div>

  {% if section.extra.journey_entry %}
  <div class="pagination">
    <ul>
      <li class="pre">
        <a href="/{{ section.extra.journey_entry }}/">
          ‚Üê {% if section.extra.journey_title %}{{ section.extra.journey_title }}{% else %}Back to Journey{% endif %}
        </a>
      </li>
    </ul>
  </div>
  {% endif %}

</article>

{% endblock content %}